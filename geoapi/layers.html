<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GeoAPI Layer Classes | RAMP4 Documentation</title>
    <meta name="generator" content="VuePress 1.8.1">
    
    <meta name="description" content="documentation site">
    
    <link rel="preload" href="/ramp4-pcar4/assets/css/0.styles.342c25e1.css" as="style"><link rel="preload" href="/ramp4-pcar4/assets/js/app.ebba11e7.js" as="script"><link rel="preload" href="/ramp4-pcar4/assets/js/2.4ff3b741.js" as="script"><link rel="preload" href="/ramp4-pcar4/assets/js/24.3cfe8e22.js" as="script"><link rel="prefetch" href="/ramp4-pcar4/assets/js/10.5e4cf612.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/11.218787cc.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/12.b4de6476.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/13.29b1622c.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/14.04a8dd84.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/15.11435cca.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/16.bca20261.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/17.12d9c0b3.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/18.52725566.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/19.13f5ed78.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/20.ac1f0338.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/21.07b54cac.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/22.f1026ba4.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/23.c9acab28.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/3.3348aff5.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/4.ec439105.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/5.abd65e2b.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/6.36d4639b.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/7.7943861c.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/8.c59bcb9a.js"><link rel="prefetch" href="/ramp4-pcar4/assets/js/9.da860eed.js">
    <link rel="stylesheet" href="/ramp4-pcar4/assets/css/0.styles.342c25e1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/ramp4-pcar4/" class="home-link router-link-active"><!----> <span class="site-name">RAMP4 Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/ramp4-pcar4/" class="nav-link">
  Current
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/ramp4-pcar4/" class="nav-link">
  Current
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>GeoAPI</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ramp4-pcar4/geoapi/layers.html" aria-current="page" class="active sidebar-link">GeoAPI Layer Classes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ramp4-pcar4/geoapi/layers.html#conceptual-fun-physical-vs-logical" class="sidebar-link">Conceptual Fun - Physical vs Logical</a></li><li class="sidebar-sub-header"><a href="/ramp4-pcar4/geoapi/layers.html#supported-layer-types" class="sidebar-link">Supported Layer Types</a></li><li class="sidebar-sub-header"><a href="/ramp4-pcar4/geoapi/layers.html#layer-creation" class="sidebar-link">Layer Creation</a></li><li class="sidebar-sub-header"><a href="/ramp4-pcar4/geoapi/layers.html#common-operations" class="sidebar-link">Common Operations</a></li><li class="sidebar-sub-header"><a href="/ramp4-pcar4/geoapi/layers.html#identify" class="sidebar-link">Identify</a></li><li class="sidebar-sub-header"><a href="/ramp4-pcar4/geoapi/layers.html#attribute-related-operations" class="sidebar-link">Attribute Related Operations</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="geoapi-layer-classes"><a href="#geoapi-layer-classes" class="header-anchor">#</a> GeoAPI Layer Classes</h1> <h2 id="conceptual-fun-physical-vs-logical"><a href="#conceptual-fun-physical-vs-logical" class="header-anchor">#</a> Conceptual Fun - Physical vs Logical</h2> <p>Layers can be viewed in two different ways due to how they are constructed.</p> <h3 id="physical-layer"><a href="#physical-layer" class="header-anchor">#</a> Physical Layer</h3> <p>This represents one slice in the map stack as it is drawn on the page. The slice can be a collection of vector geometries, or an image (also known as a raster). The image can be composed of pictures (e.g. a satellite image) or the rasterization of vector geometries.</p> <p>The <code>Layer</code> objects from GeoAPI maintain a one-to-one relationship with a physical layer in the map.</p> <h3 id="logical-layer"><a href="#logical-layer" class="header-anchor">#</a> Logical Layer</h3> <p>These represent a logical set of geographic data. The term &quot;Feature Class&quot; is often used to describe logical sets of vector data and their attributes. We also include other types of data in our definition, such as a set of images. Generally, one would expect items within a logical layer to share common characteristics, like geometry type, attribute field schema, projection, visible scale levels, etc.</p> <p>While most physical layers have one logical layer, some can have multiple logical layers. For example, an ESRI Map Image Layer (formerly known as a Dynamic Layer) can be composed of many feature classes from the server, and are all rendered into a single image to be placed in the map stack.</p> <h3 id="layer-tree-uids-and-fancy-parameters"><a href="#layer-tree-uids-and-fancy-parameters" class="header-anchor">#</a> Layer Tree, UIDs, and Fancy Parameters</h3> <p>Every <code>Layer</code> object has a method <code>.getLayerTree()</code>. This returns a heirarchical object that describes the logical layout of the layer.</p> <p>Most layers have one single logical component and a basic tree. The structure is a bit redundant, but keeps things aligned and predictable.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    layerIdx<span class="token operator">:</span> <span class="token number">-1</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&quot;Fancy Layer&quot;</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            layerIdx<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            name<span class="token operator">:</span> <span class="token string">&quot;Fancy Layer&quot;</span><span class="token punctuation">,</span>
            children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            isLayer<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            uid<span class="token operator">:</span> <span class="token string">&quot;432rubbishasdfsdfad&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    isLayer<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    uid<span class="token operator">:</span> <span class="token string">&quot;ABCDskipafewYbecauseihavetogo4aP&amp;Z4U&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>A Map Image Layer composed of multiple sources could have a more structured result.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    layerIdx<span class="token operator">:</span> <span class="token number">-1</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&quot;Restaurants&quot;</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            layerIdx<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            name<span class="token operator">:</span> <span class="token string">&quot;Fine Dining&quot;</span><span class="token punctuation">,</span>
            children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            isLayer<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            uid<span class="token operator">:</span> <span class="token string">&quot;432rubbishasdfsdfad&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            layerIdx<span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
            name<span class="token operator">:</span> <span class="token string">&quot;Fast Food&quot;</span><span class="token punctuation">,</span>
            children<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    layerIdx<span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
                    name<span class="token operator">:</span> <span class="token string">&quot;Burger Joints&quot;</span><span class="token punctuation">,</span>
                    children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    isLayer<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                    uid<span class="token operator">:</span> <span class="token string">&quot;765rubbishasdfsdfad&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    layerIdx<span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
                    name<span class="token operator">:</span> <span class="token string">&quot;Pizza Parlours&quot;</span><span class="token punctuation">,</span>
                    children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    isLayer<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                    uid<span class="token operator">:</span> <span class="token string">&quot;988rubbishasdfsdfad&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            isLayer<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            uid<span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    isLayer<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    uid<span class="token operator">:</span> <span class="token string">&quot;ABCDskipafewYbecauseihavetogo4aP&amp;Z4U&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>There are two ways to reference parts of the layer structure.</p> <p><code>uid</code>s are used to uniquely identify both physical and logical layers in <code>Layer</code> objects. Note that sub-folder structures for Map Image Layers do not have a <code>uid</code>.</p> <p><code>layerIdx</code> indicates the index on the server for the item. We use <code>-1</code> as a placeholder index value to denote the physical layer root. For layers that are not tied to an ArcGIS Server, we use <code>0</code> as the index value.</p> <p>Most methods on the <code>Layer</code> objects support an optional parameter to target the logical layer to use in the method. This parameter can be the <code>layerIdx</code> (integer), the <code>uid</code> (string), or can be left blank in most cases.</p> <p>If a layer is not a Map Image Layer, leaving the parameter blank will cause the layer to use the one and only logical layer. For a Map Image Layer, the blank parameter will target the layer's root (e.g. to set the visibility of the entire layer image instead of adjusting one of the component logical sublayers). If the method makes no sense on the layer root (e.g. asking for a record count), an error will be thrown.</p> <p>Examples</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// using the first simple tree sample</span>
fancyLayer<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Fancy Layer&quot;</span>
fancyLayer<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Fancy Layer&quot;</span>
fancyLayer<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token string">'ABCDskipafewYbecauseihavetogo4aP&amp;Z4U'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Fancy Layer&quot;</span>
fancyLayer<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error</span>

<span class="token comment">// using the second Map Image Layer tree sample</span>
restoLayer<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Restaurants&quot;</span>
restoLayer<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Restaurants&quot;</span>
restoLayer<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token string">'ABCDskipafewYbecauseihavetogo4aP&amp;Z4U'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Restaurants&quot;</span>
restoLayer<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Burger Joints&quot;</span>
restoLayer<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token string">'988rubbishasdfsdfad'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Pizza Parlours&quot;</span>
restoLayer<span class="token punctuation">.</span><span class="token function">getFeatureCount</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 324</span>
restoLayer<span class="token punctuation">.</span><span class="token function">getFeatureCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error</span>
</code></pre></div><h2 id="supported-layer-types"><a href="#supported-layer-types" class="header-anchor">#</a> Supported Layer Types</h2> <ul><li>ESRI Feature Layer (ArcGIS Server)</li> <li>ESRI Map Image Layer (ArcGIS Server) (formerly known as Dynamic Layer)</li> <li>GeoJSON</li> <li>WFS 3.0</li></ul> <p><em>Planned Additional Support</em></p> <ul><li>ESRI Tile Layer</li> <li>ESRI Image Service</li> <li>WMS</li> <li>CSV</li> <li>Shapefile</li></ul> <h2 id="layer-creation"><a href="#layer-creation" class="header-anchor">#</a> Layer Creation</h2> <p>Layers are created by providing a configuration object (and layer data if the layer is not sourced from a supported web service) to a creation function in the GeoAPI.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> simpleConfig <span class="token operator">=</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">&quot;funlayer&quot;</span><span class="token punctuation">,</span> url<span class="token operator">:</span> <span class="token string">&quot;http://maptown.com/maps/rest/fancyService/4&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> featureLayer <span class="token operator">=</span> geoapi<span class="token punctuation">.</span>layers<span class="token punctuation">.</span><span class="token function">createFeatureLayer</span><span class="token punctuation">(</span>simpleConfig<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="creation-functions"><a href="#creation-functions" class="header-anchor">#</a> Creation Functions</h3> <ul><li><code>layers.createFeatureLayer(config)</code></li> <li><code>layers.createMapImageLayer(config)</code></li> <li><code>layers.createGeoJSONLayer(config, geoJson, options)</code></li></ul> <p><em>Coming Soon</em></p> <ul><li><code>layers.createLayer(config)</code> (general purpose, will read the <code>.layerType</code> property and return the appropriate flavour of layer)</li> <li><code>layers.createTileLayer(config)</code></li> <li><code>layers.createWmsLayer(config)</code></li> <li><code>layers.createCsvLayer(config)</code></li> <li><code>layers.createShapeFileLayer(config)</code></li> <li><code>layers.createImageryLayer(config)</code></li> <li><code>layers.createHighlightLayer(config)</code></li></ul> <h2 id="common-operations"><a href="#common-operations" class="header-anchor">#</a> Common Operations</h2> <p>In general, these items should only be accessed after the layer has loaded. Attempts to use prior to that may result in the data not existing. The perscribed way to do this is as follows. Of course, you can gate areas of logic so that code only runs after the layer is known to be loaded, and then you don't need to continually check the status.</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span><span class="token function">isLayerLoaded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// access layer data</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Supports:</strong> All Layer types</p> <h3 id="visibility-and-opacity"><a href="#visibility-and-opacity" class="header-anchor">#</a> Visibility and Opacity</h3> <p>For <code>Layer</code>s with singular logical sublayers (every layer type except Map Image Layer), the visibility and opacity effect the entire layer. For Map Image Layers, the sublayers can be independently adjusted (some services may not support sublayer opacity).</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myLayer<span class="token punctuation">.</span><span class="token function">getVisibility</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
myMapImgLayer<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">'sublayeruid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

myLayer<span class="token punctuation">.</span><span class="token function">setOpacity</span><span class="token punctuation">(</span><span class="token number">0.6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myLayer<span class="token punctuation">.</span><span class="token function">getOpacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0.6</span>
myMapImgLayer<span class="token punctuation">.</span><span class="token function">setOpacity</span><span class="token punctuation">(</span><span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// using index 3 instead of uid</span>
myMapImgLayer<span class="token punctuation">.</span><span class="token function">setOpacity</span><span class="token punctuation">(</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// setting opacity of entire layer image</span>
</code></pre></div><h3 id="layer-metadata"><a href="#layer-metadata" class="header-anchor">#</a> Layer Metadata</h3> <p>Get the layer name (defined by configuration, and if not supplied, any server value that is present).</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Fancy Layer&quot;</span>
</code></pre></div><p>Get the state of the layer. This property does not apply to sublayers.</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span>state<span class="token punctuation">;</span> <span class="token comment">// 'rv-loaded'</span>
</code></pre></div><p>Determine if the layer is in a valid state. Invalid states would be pre-loaded or an error state. This can also be used as an alternative to <code>isLayerLoaded()</code> if the calling code does not require a <code>Promise</code> to wait on. This property does not apply to sublayers.</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span><span class="token function">isValidState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>Get the visible scale ranges for layer or sublayer. A value of <code>0</code> on a range indicates there is no limit. Scales are fractions (i.e. a value of <code>2000</code> actually means 1/2000 scale), so <code>min</code> and <code>max</code> are counter intuitive (large scale means the view is closer to real life size, so the viewport is closer to the ground level).</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span><span class="token function">getScaleSet</span><span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { minScale: 0, maxScale: 8500 }</span>
</code></pre></div><p>Determine if the layer supports our standard features.</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span><span class="token function">supportsFeatures</span><span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>Get legend iconography and names.</p> <p>TODO hotlink to any symbology / legend pages we create.</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span><span class="token function">getLegend</span><span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [{ legend object }, { legend object }]</span>
</code></pre></div><p>Determine if the layer is file-based (this includes WFS, as it gets pre-loaded and is disconnected from its service while on the map). This property does not apply to sublayers.</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span>isFile<span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre></div><h2 id="identify"><a href="#identify" class="header-anchor">#</a> Identify</h2> <p><strong>Supports:</strong> Feature Layers, Map Image Layers, WMS Layers, WFS Layers, File-Based Layers</p> <p>dont forget <code>supportsIdentify</code> property.</p> <p>Determine if the layer supports the identify function. This property does not apply to sublayers. This property exists on all layer types, not just the supported ones.</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span>supportsIdentify<span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>Run an identify on the layer. Identify is not directly called on logical sublayers. COMING SOON the ability to omit sublayers from the request.</p> <p>Options parameter object:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
   geometry<span class="token punctuation">,</span>       <span class="token comment">// The geometry to query. A RAMP API Geometry. Intersecting features will be returned.</span>
   map<span class="token punctuation">,</span>            <span class="token comment">// the current GeoAPI map object. This is used to provide metadata about the current view.</span>
   returnGeometry<span class="token punctuation">,</span> <span class="token comment">// an optional boolean to indicate the geometry of the result features should also be downloaded. Defaults to `false`</span>
   tolerance       <span class="token comment">// an optional integer number to buffer the query geometry. Is only useful if the geometry is a point.</span>
                   <span class="token comment">// The number represents pixels to buffer by (so 5 would be a 10x10 pixel square around the point at the current map scale level).</span>
                   <span class="token comment">// TODO if there is a default, list it here.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The result object is on the fancy side, as there are a few levels identify acts up. The topmost level is tied to the <code>Layer</code> object, providing the layer <code>uid</code>, a promise that resolves on completion, and the array of results. The result array has an entry for each logical layer involved, including the logical <code>uid</code>, a loading flag, and another array of results (called items) for the logical layer. The items array contains a format specification and a property containing data that aligns to the given format. TODO flush out formats once things are nailed down.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    parentUid<span class="token punctuation">,</span>               <span class="token comment">// uid of the layer object</span>
    done<span class="token punctuation">,</span>                    <span class="token comment">// a promise, resolves when request is done</span>
    results<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            uid<span class="token punctuation">,</span>             <span class="token comment">// uid of the sublayer / logical layer this set of results belongs to</span>
            isLoading<span class="token punctuation">,</span>       <span class="token comment">// boolean flag indicating if items are still loading</span>
            items<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    format<span class="token punctuation">,</span>  <span class="token comment">// string indicating what format the data is in</span>
                    data     <span class="token comment">// the data describing an item that satisfied the identify request</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token operator">...</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token operator">...</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Example call</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> opts <span class="token operator">=</span> <span class="token punctuation">{</span> geometry<span class="token operator">:</span> myPoint<span class="token punctuation">,</span> tolerance<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> myLayer<span class="token punctuation">.</span><span class="token function">identify</span><span class="token punctuation">(</span>opts<span class="token punctuation">)</span><span class="token punctuation">;</span>
result<span class="token punctuation">.</span>done<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    result<span class="token punctuation">.</span>results<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">r</span> <span class="token operator">=&gt;</span> <span class="token function">processResults</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="attribute-related-operations"><a href="#attribute-related-operations" class="header-anchor">#</a> Attribute Related Operations</h2> <p><strong>Supports:</strong> Feature Layers, Map Image Layers, WFS Layers, File Based Layers</p> <p>Note that Map Image Layers can have sublayers that are Raster in nature. These sublayers will not return any meaningful results for Attribute related calls.</p> <p>Attribute operations always target a logical layer. Attempts to call operations against a Map Image Layer while targeting the layer root or not providing a sublayer identifier will result in errors thrown.</p> <p>Get the total number of features in a logical layer.</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span><span class="token function">getFeatureCount</span><span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 254</span>
</code></pre></div><p>Get the geometry type of the logical layer.</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span><span class="token function">getGeomType</span><span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;polygon&quot;</span>
</code></pre></div><p>Request the set of attributes for the logical layer. The first request will incur the server hit. Subsequent requests will use the cached result. TODO flush out the return value</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span><span class="token function">getAttributes</span><span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Promise resolving with a set of attributes.</span>
</code></pre></div><p>Request the loading process of attributes be halted. The end result of this request is the appearance of the layer not having loaded attributes. TODO figure out and document how the load count/status can be monitored.</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span><span class="token function">abortAttributeLoad</span><span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Remove any attributes that had been loaded. The end result of this request is the appearance of the layer not having loaded attributes. Note this will not interrupt any loading process that is currently active. Use <code>abortAttributeLoad</code> to interrupt any enormous loads or hung calls.</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span><span class="token function">destroyAttributes</span><span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Request the attributes in a tabular format with column metadata, suitable for grid or table consumption. This will use any pre-loaded attribute set, and if none exist, will execute the <code>getAttributes</code> request. TODO flush out the return value</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span><span class="token function">getTabularAttributes</span><span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Promise resolving with tabular attribute object.</span>
</code></pre></div><p>Request an individual graphic. This can include the geometry, the attributes, or both. The <code>map</code> option only needs to be provided if <code>getGeom</code> is set to <code>true</code>. The function uses a caching strategy so multiple requests for the same data will be server friendly. TODO flush out details.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> opts <span class="token operator">=</span> <span class="token punctuation">{</span> getGeom<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> getAttribs<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> map<span class="token operator">:</span> myMap <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> objectId <span class="token operator">=</span> <span class="token number">61</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> myLayer<span class="token punctuation">.</span><span class="token function">getGraphic</span><span class="token punctuation">(</span>objectId<span class="token punctuation">,</span> opts<span class="token punctuation">,</span> <span class="token string">'guid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
result<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">g</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span>attributes<span class="token punctuation">,</span> g<span class="token punctuation">.</span>geometry<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Request the icon symbol for a specific feature. The icon corresponds to the legend representation of how the layer renderer would display this feature. The icon is encoded as an SVG string.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> objectId <span class="token operator">=</span> <span class="token number">61</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> myLayer<span class="token punctuation">.</span><span class="token function">getIcon</span><span class="token punctuation">(</span>objectId<span class="token punctuation">,</span> <span class="token string">'guid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
result<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">svg</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>svg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="filters"><a href="#filters" class="header-anchor">#</a> Filters</h3> <p>Apply a SQL filter on a logical layer. This will alert any listeners on the <code>layer.filterChanged</code> event. Core SQL filters include <code>grid</code>, <code>symbol</code>, and <code>api</code></p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span><span class="token function">setSqlFilter</span><span class="token punctuation">(</span><span class="token string">'dogfilter'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">breed = 'terrier'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token string">'uid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Get the current value of a SQL filter on a logical layer.</p> <div class="language-js extra-class"><pre class="language-js"><code>myLayer<span class="token punctuation">.</span><span class="token function">getSqlFilter</span><span class="token punctuation">(</span><span class="token string">'dogfilter'</span><span class="token punctuation">,</span> <span class="token string">'uid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;breed = 'terrier'&quot;</span>
</code></pre></div><p>Get an array of object ids that currently satisfy all active filters. An exclusion list can be provided, this will cause the result to ignore the effects of all filters being excluded. A map Extent can also be provided to limit the results to a given section of the map.</p> <p>Requests for OIDs use a caching strategy, so multiple requests when nothing has changed will be server friendly.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// exclude our dog filter. respect all dogs</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> myLayer<span class="token punctuation">.</span><span class="token function">getFilterOIDs</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'dogfilter'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> myMap<span class="token punctuation">.</span>extent<span class="token punctuation">,</span> <span class="token string">'guid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
result<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">oids</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    oids<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">oid</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'matched this object id'</span><span class="token punctuation">,</span> oid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// sample call without any fancy parameters</span>
<span class="token keyword">var</span> fullFilterResult <span class="token operator">=</span> myLayer<span class="token punctuation">.</span><span class="token function">getFilterOIDs</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token string">'guid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// with a non-Map Image Layer, everything can be defaulted</span>
<span class="token keyword">var</span> fullFilterResult <span class="token operator">=</span> myLayer<span class="token punctuation">.</span><span class="token function">getFilterOIDs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Apply all active SQL filters to the layer on the map. This will actually change how the layer appears on the map; features that don't pass the filter will not appear. Again, we can provide an exclusion array of keys to omit certain filters from the action</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// use all filters</span>
myLayer<span class="token punctuation">.</span><span class="token function">applySqlFilter</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token string">'uid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ignore the grid filters</span>
myLayer<span class="token punctuation">.</span><span class="token function">applySqlFilter</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'grid'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'uid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/ramp4-pcar4/assets/js/app.ebba11e7.js" defer></script><script src="/ramp4-pcar4/assets/js/2.4ff3b741.js" defer></script><script src="/ramp4-pcar4/assets/js/24.3cfe8e22.js" defer></script>
  </body>
</html>
